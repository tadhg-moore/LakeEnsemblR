<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Run Ensemble of Lake Models • LakeEnsemblR</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Run Ensemble of Lake Models">
<meta name="description" content="Run ensemble of lake models cross-platform and tools for analyzing model output.">
<meta property="og:description" content="Run ensemble of lake models cross-platform and tools for analyzing model output.">
<meta property="og:image" content="https://tadhg-moore.github.io/LakeEnsemblR/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">LakeEnsemblR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/LakeEnsemblR_vignette.html">R package LakeEnsemblR: Basic Use and Sample Applications</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aemon-j/LakeEnsemblR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="id_-lakeensemblr-"># LakeEnsemblR 
<a class="anchor" aria-label="anchor" href="#id_-lakeensemblr-"></a>
</h1>
</div>
<p><a href="https://github.com/aemon-j/LakeEnsemblR/actions" class="external-link"><img src="https://github.com/aemon-j/LakeEnsemblR/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a> <a href="https://codecov.io/github/aemon-j/LakeEnsemblR/" class="external-link"><img src="https://codecov.io/github/aemon-j/LakeEnsemblR/branch/master/graphs/badge.svg" alt="codecov"></a> <a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a> <a href="https://zenodo.org/badge/latestdoi/217581132" class="external-link"><img src="https://zenodo.org/badge/217581132.svg" alt="DOI"></a> <a href="https://juleskreuer.eu/projekte/citation-badge/" class="external-link"><embed src="https://api.juleskreuer.eu/citation-badge.php?doi=10.1016/j.envsoft.2021.105101"></embed></a></p>
<p>Tools for running an ensemble of lake models using standardised input data. Lake models currently incorporated are <a href="http://www.flake.igb-berlin.de/" class="external-link">Freshwater Lake Model (FLake)</a>, <a href="http://aed.see.uwa.edu.au/research/models/GLM/" class="external-link">General Lake Model (GLM)</a>, <a href="https://gotm.net/" class="external-link">General Ocean Turbulence Model (GOTM)</a> (lake-branch), <a href="https://www.eawag.ch/en/department/surf/projects/simstrat/" class="external-link">Simstrat</a>, and <a href="https://github.com/biogeochemistry/MyLake_public" class="external-link">MyLake</a>.</p>
<p>You can find example setups here: <a href="https://github.com/aemon-j/LER_examples" class="external-link uri">https://github.com/aemon-j/LER_examples</a>.</p>
<p>Check out our published paper <a href="https://doi.org/10.1016/j.envsoft.2021.105101" class="external-link">here</a>.</p>
<p>In v1.1, some changes occurred in the configuration file. If you want to adapt your existing setup, see: <a href="https://github.com/aemon-j/LakeEnsemblR/wiki/From-v1.0-to-v1.1" class="external-link uri">https://github.com/aemon-j/LakeEnsemblR/wiki/From-v1.0-to-v1.1</a></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Prior to installing the package, you will need to install the packages which run the models and the tools for manipulating model data from GitHub. It is recommended to do this each time before testing to ensure all packages are up-to-date as parallel development might be ongoing.</p>
<p><code>{r gh-installation, eval = FALSE} #install.packages("remotes") remotes::install_github("GLEON/rLakeAnalyzer") remotes::install_github("aemon-j/GLM3r", ref = "v3.1.1") remotes::install_github("USGS-R/glmtools", ref = "ggplot_overhaul") remotes::install_github("aemon-j/FLakeR", ref = "inflow") remotes::install_github("aemon-j/GOTMr") remotes::install_github("aemon-j/gotmtools") remotes::install_github("aemon-j/SimstratR") remotes::install_github("aemon-j/MyLakeR")</code></p>
<p>Following this you can install <code>LakeEnsemblR</code> from Github with:</p>
<p><code>{r gh-installation, eval = FALSE} # install.packages("remotes") remotes::install_github("aemon-j/LakeEnsemblR")</code></p>
<p>Should you run into unexpected installation issues, please have a look at this page: <a href="https://github.com/aemon-j/LakeEnsemblR/wiki/Installation-issues" class="external-link uri">https://github.com/aemon-j/LakeEnsemblR/wiki/Installation-issues</a></p>
<div class="section level3">
<h3 id="visualize">Visualize<a class="anchor" aria-label="anchor" href="#visualize"></a>
</h3>
<p>You can download <a href="http://sourceforge.net/projects/pyncview/" class="external-link">PyNcView</a>, a cross-platform NetCDF viewer, for viewing the NetCDF output.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-model-run">Example model run<a class="anchor" aria-label="anchor" href="#example-model-run"></a>
</h2>
<p>```{r gh-installation, eval = FALSE}</p>
</div>
</div>
<div class="section level1">
<h1 id="load-lakeensemblr">Load LakeEnsemblR<a class="anchor" aria-label="anchor" href="#load-lakeensemblr"></a>
</h1>
<p>library(LakeEnsemblR)</p>
</div>
<div class="section level1">
<h1 id="copy-template-folder">Copy template folder<a class="anchor" aria-label="anchor" href="#copy-template-folder"></a>
</h1>
<p>template_folder &lt;- system.file(“extdata/feeagh”, package= “LakeEnsemblR”) dir.create(“example”) # Create example folder file.copy(from = template_folder, to = “example”, recursive = TRUE) setwd(“example/feeagh”) # Change working directory to example folder</p>
</div>
<div class="section level1">
<h1 id="set-config-file--models">Set config file &amp; models<a class="anchor" aria-label="anchor" href="#set-config-file--models"></a>
</h1>
<p>config_file &lt;- “LakeEnsemblR.yaml” model &lt;- c(“FLake”, “GLM”, “GOTM”, “Simstrat”, “MyLake”)</p>
</div>
<div class="section level1">
<h1 id="example-run">Example run<a class="anchor" aria-label="anchor" href="#example-run"></a>
</h1>
</div>
<div class="section level1">
<h1 id="id_1-export-settings---creates-directories-with-all-model-setups-and-exports-settings-from-the-ler-configuration-file">1. Export settings - creates directories with all model setups and exports settings from the LER configuration file<a class="anchor" aria-label="anchor" href="#id_1-export-settings---creates-directories-with-all-model-setups-and-exports-settings-from-the-ler-configuration-file"></a>
</h1>
<p>export_config(config_file = config_file, model = model)</p>
</div>
<div class="section level1">
<h1 id="id_2-run-ensemble-lake-models">2. Run ensemble lake models<a class="anchor" aria-label="anchor" href="#id_2-run-ensemble-lake-models"></a>
</h1>
<p>run_ensemble(config_file = config_file, model = model)</p>
<pre><code>
## Post-processing
```{r gh-installation, eval = FALSE}

# Load libraries for post-processing
library(gotmtools)
library(ggplot2)

## Plot model output using gotmtools/ggplot2
# Extract names of all the variables in netCDF
ncdf &lt;- "output/ensemble_output.nc"
vars &lt;- gotmtools::list_vars(ncdf)
vars # Print variables

p1 &lt;- plot_heatmap(ncdf)
p1
# Change the theme and increase text size for saving
p1 &lt;- p1 +
  theme_classic(base_size = 24) +
  scale_colour_gradientn(limits = c(0, 21),
                         colours = rev(RColorBrewer::brewer.pal(11, "Spectral")))
# Save as a png file
ggsave("output/ensemble_heatmap.png", p1,  dpi = 300,width = 384,height = 280, units = "mm")
</code></pre>
<p><img src="images/ensemble_heatmap.png"><!-- --></p>
<div class="section level2">
<h2 id="plot-ensemble-output">Plot Ensemble output<a class="anchor" aria-label="anchor" href="#plot-ensemble-output"></a>
</h2>
<p>```{r gh-installation, eval = FALSE} # Plot ensemble mean at 0.9m model = c(“FLake”, “GLM”, “GOTM”, “Simstrat”, “MyLake”) plot_ensemble(ncdf = ncdf, model = model, var = “temp”, depth = 0.9)</p>
</div>
</div>
<div class="section level1">
<h1 id="load-watertemp-from-netcdf-file-as-a-list">Load watertemp from netCDF file as a list<a class="anchor" aria-label="anchor" href="#load-watertemp-from-netcdf-file-as-a-list"></a>
</h1>
<p>wtemp &lt;- load_var(ncdf = ncdf, var = “temp”, return = “list”) names(wtemp)</p>
</div>
<div class="section level1">
<h1 id="plot-residual-diagnostic-plots">Plot residual diagnostic plots<a class="anchor" aria-label="anchor" href="#plot-residual-diagnostic-plots"></a>
</h1>
<p>plots &lt;- plot_resid(var_list = wtemp) # Plot residuals - returns a list of plots names(plots) #</p>
</div>
<div class="section level1">
<h1 id="plot-residuals-vs-depth-res_depth">Plot residuals vs. depth (“res_depth”)<a class="anchor" aria-label="anchor" href="#plot-residuals-vs-depth-res_depth"></a>
</h1>
<p>plots[[2]]</p>
</div>
<div class="section level1">
<h1 id="analyse-the-netcdf-output">Analyse the netCDF output<a class="anchor" aria-label="anchor" href="#analyse-the-netcdf-output"></a>
</h1>
<p>out &lt;- analyse_ncdf(ncdf, model = model, spin_up = 0) names(out) str &lt;- out[[“strat”]] str[str$year == 2010, ] stats &lt;- out[[“stats”]] stats</p>
<pre><code>See the [vignette](https://github.com/aemon-j/LakeEnsemblR/blob/master/vignettes/LakeEnsemblR_vignette.pdf) for further examples.


How do I setup `LakeEnsemblR` for my lake?
=========================================================
Head on over to our [Wiki](https://github.com/aemon-j/LakeEnsemblR/wiki) for guides on how to set up your lake for LakeEnsemblR

How do I contribute new code back to the `LakeEnsemblR` project?
==========================================================

In order to contribute to this code, we recommend the following workflow:

1.  "fork" this repository to your own personal github account

2.  clone the github repository to your computer:

    $git clone &lt;git@github.com:{username}/LakeEnsemblR.git&gt;

3.  modify code or add new functionality, save the code

4.  add the repository master to a remote master called "upstream"

    $cd LakeEnsemblR

    $git remote add upstream &lt;git@github.com:aemon-j/LakeEnsemblR.git&gt;

5.  before pushing your changes to your repository, pull in the current version of the aemon-j master:

    $git fetch upstream

6.  merge these differences with your own "master" version:

    $git merge upstream/master

7.  push your changes to your github repository, in addition to changes made by pulling in the aemon-j master:

    $git push

8.  submit a pull request to aemon-j master using your account at github.com


Information for macOS users
=========================================================
To ensure that all model binaries work, we advise you to install the specific macOS packages (currently in a separated branch):</code></pre>
<p>remotes::install_github(“aemon-j/GLM3r”, ref = “macOS”) remotes::install_github(“aemon-j/FLakeR”, ref = “macOS”) remotes::install_github(“aemon-J/GOTMr”, ref = “macOS”) remotes::install_github(“aemon-j/SimstratR”, ref = “macOS”) ```</p>
<p>Unfortunately, this means your version of GLM will differ compared to the one included in the executables for Windows and Linux. GLM on macOS will be version 3.2.0a8 (most recent one on January 13, 2022), Windows/Linux use 3.1.1.</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/aemon-j/LakeEnsemblR/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-2" class="external-link">GPL-2</a>.0</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing LakeEnsemblR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tadhg Moore <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tadhg Moore.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
